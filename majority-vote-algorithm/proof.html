<!DOCTYPE html>
<script src="./colors.js"></script>
<script src="./algorithm.js"></script>

<div id="graph1Container"></div>
<script type="module">
// Created largely by generative AI

import * as d3 from "https://cdn.jsdelivr.net/npm/d3@7/+esm";

// Config
const width = 500;
const height = 300;

const marginTop = 20;
const marginRight = 20;
const marginBottom = 30;
const marginLeft = 40;

const xMax = 17;
const xMin = -1;
const yMax = 4;
const yMin = -0.5;

const xTicksCountApprox = xMax;
const yTicksCountApprox = yMax;
const yAxisFontSize = "20px";

const inputSymbolY = -0.8;

// Data
const rawInputSymbols = [
  blue,
  blue,
  red,
  blue,
  red,
  yellow,
  yellow,
  red,
  red,
  red,
];
const inputSymbols = rawInputSymbols.map(
  (symbol, i) => ({
    x: i + 1,
    color: symbol,
  })
);
const algorithmStates = getAlgorithmStates(rawInputSymbols);

// Create SVG
const svg = d3.create("svg")
  .attr("width", width)
  .attr("height", height);
graph1Container.append(svg.node());

// Axes
const x = d3.scaleLinear()
  .domain([xMin, xMax])
  .range([marginLeft, width - marginRight]);
const y = d3.scaleLinear()
  .domain([yMin, yMax])
  .range([height - marginBottom, marginTop]);
svg.append("g")
  .attr("transform", `translate(${marginLeft},0)`)
  .call(d3.axisLeft(y).ticks(yTicksCountApprox).tickFormat(d3.format("d")))
  .selectAll("text")
  .style("font-size", yAxisFontSize);

// Grid lines
const gridX = svg.append("g")
  .attr("class", "grid")
  .attr("transform", `translate(0,${height - marginBottom})`)
  .call(d3.axisBottom(x)
    .ticks(xTicksCountApprox)
    .tickSize(-height + marginTop + marginBottom)
    .tickFormat("")
  );
const gridY = svg.append("g")
  .attr("class", "grid")
  .attr("transform", `translate(${marginLeft},0)`)
  .call(d3.axisLeft(y)
    .ticks(4)
    .tickSize(-width + marginLeft + marginRight)
    .tickFormat("")
  );
svg.selectAll(".grid line")
  .attr("stroke", "lightgrey")
  .attr("stroke-opacity", 0.7)

// Draw the line between points in `algorithmStates`
const line = d3.line()
  .x(d => x(d.x))
  .y(d => y(d.y));
svg.append("path")
  .datum(algorithmStates)
  .attr("fill", "none")
  .attr("stroke", "black")
  .attr("stroke-width", 2)
  .attr("d", line);

// Draw the points in `algorithmStates`
svg.selectAll("circle.algorithmStates")
  .data(algorithmStates)
  .enter().append("circle")
  .attr("class", "algorithmStates")
  .attr("cx", d => x(d.x))
  .attr("cy", d => y(d.y))
  .attr("r", 5)
  .attr("stroke", "black")
  .attr("stroke-dasharray", d => d.dotted ? "1.5" : "none")
  .attr("fill", d => d.color);

// Draw the points in `inputSymbols`
svg.selectAll("circle.inputSymbols")
  .data(inputSymbols)
  .enter().append("circle")
  .attr("class", "inputSymbols")
  .attr("cx", d => x(d.x))
  .attr("cy", d => y(inputSymbolY))
  .attr("r", 5)
  .attr("stroke", "black")
  .attr("fill", d => d.color);
</script>
